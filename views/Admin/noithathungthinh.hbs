<section class="nine columns main-content" style="position: relative">
  <div>
    <table>
      <tr>
        <th>Tiêu đề</th>
        <th>link</th>
        <th>Lệnh</th>
      </tr>
      {{#each data}}
        <tr>
          <td>{{title}}</td>
          <td>{{url}}</td>
          <td style="margin-left: 10px;">
            <button class="editCategory" idArticle= {{id}} style="display: inline-block;float:left; margin-left:10px;">Edit</button>
            <button class="deleteCategory" idArticle= {{id}} style="display: inline-block ;float:right;margin-right:10px">Delete</button>
          </td>
        </tr>
      {{/each}}
    </table>
  </div>

  <div class="u-full-width add-article-noithathungthinh">
    <h2>Nội thất Hưng Thinh</h2>
    <form name="myForm" onsubmit="return validateForm()" class="row" method="POST" action="noi-that-hung-thinh/add" enctype="multipart/form-data" id="user-data">
      <div class="five columns">
        Tiêu đề bài viết:
        <br>
        <input type="text" name="title" value="" size="35">
        <br> Đường đẫn bài viết:
        <br>
        <input type="text" name="url" value="" size="35">
        <br> Danh mục
        <br>
        <select name="type" form="user-data" style="color:#000">
          <option value="1">Nệm</option>
          <option value="2">Giường, tủ</option>
          <option value="3">Chăn, drap, gối</option>
        </select>
        <br>
        <input id="upload-input" type="file" accept="image/gif, image/jpg, image/jpeg, image/png" name="image" multiple="multiple" style="color: white !important" />
        <br>
        <div>
          <div style="display: flex">
            <div>Mã sản phẩm <input id="product_code" type="text" name="product_code" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Chất liệu <input id="material" type="text" name="material" size="10" /></div>
          </div>
          <br>
          <div style="display: flex">
            <div>Kích thước <input id="size" type="text" name="size" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Màu sắc <input id="color" type="text" name="color" size="10" /></div>
          </div>
          <br>
          <div style="display: flex">
            <div>Bảo hành <input id="guarantee" type="text" name="guarantee" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Trạng thái <input id="status" type="text" name="status" size="10" /></div>
          </div>
          <br>
          <div style="display: flex">
            <div>Giá thật <input id="price-real" type="text" name="price-real" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Giá khuyến mãi <input id="price-promotion" type="text" name="price-promotion" size="10" /></div>
          </div>
        </div>
      </div>

      <div class="six columns">
        <textarea name="content" id="editor2" rows="5" cols="80">
        </textarea>

        <br>
        <button type="submit" id="add-article" style="color: #fff">Add</button>
        <button type="button" id="close-add-article">Close</button>
      </div>
    </form>
  </div>

  <div class="u-full-width edit-article-noithathungthinh">
    <h2>Edit data</h2>
    <form name="myForm" onsubmit="return validateForm()" class="row" method="POST" action="noi-that-hung-thinh/update"
      enctype="multipart/form-data" id="user-data">
      <div class="five columns">
        <input id="edit-id" type="text" name="id" value="" size="35" style="display:none">
        Tiêu đề bài viết:
        <br>
        <input id="edit-title" type="text" name="title" value="" size="35">
        <br> Đường đẫn bài viết:
        <br>
        <input id="edit-url" type="text" name="url" value="" size="35">
        <br> Danh mục
        <br>
        <select id="edit-type" name="type" style="color:#000">
          <option value="1">Nệm</option>
          <option value="2">Giường, tủ</option>
          <option value="3">Chăn, drap, gối</option>
        </select>
        <!-- <br> Đường đẫn image: -->
        <br>
        <input id="edit-imageULR" type="text" name="urlImage" size="35" style="display:none"/>
        <br>
        <input id="upload-input" type="file" accept="image/gif, image/jpg, image/jpeg, image/png" name="image" multiple="multiple" style="color: white !important" />
        <br>
        <div>
          <div style="display: flex">
            <div>Mã sản phẩm <input id="edit-product_code" type="text" name="product_code" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Chất liệu <input id="edit-material" type="text" name="material" size="10" /></div>
          </div>
          <br>
          <div style="display: flex">
            <div>Kích thước <input id="edit-size" type="text" name="size" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Màu sắc <input id="edit-color" type="text" name="color" size="10" /></div>
          </div>
          <br>
          <div style="display: flex">
            <div>Bảo hành <input id="edit-guarantee" type="text" name="guarantee" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Trạng thái <input id="edit-status" type="text" name="status" size="10" /></div>
          </div>
          <br>
          <div style="display: flex">
            <div>Giá thật <input id="edit-price-real" type="text" name="price-real" size="10" /></div>
            <div style="width: 5px"></div>
            <div>Giá khuyến mãi <input id="edit-price-promotion" type="text" name="price-promotion" size="10" /></div>
          </div>
        </div>
      </div>

      <div class="six columns">
        <textarea name="content" id="editor1" rows="5" cols="80">
        </textarea>

        <br>
        <button type="submit" id="edit-article" style="color: #fff">Update</button>
        <button type="button" id="close-edit-article">Close</button>
      </div>
    </form>
  </div>
</section>


<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
<script>
  CKEDITOR.replace('editor2', {
    extraPlugins: 'uploadimage,image2',
    height: 300,
    filebrowserBrowseUrl: '/Filemanager/',
    filebrowserUploadUrl: '/uploader1/upload?Type=File',
    filebrowserImageUploadUrl: '/uploader1/upload?Type=Image',
    filebrowserFlashUploadUrl: '/uploader1/upload?Type=Flash',
    stylesSet: [{
        name: 'Narrow image',
        type: 'widget',
        widget: 'image',
        attributes: {
          'class': 'image-narrow'
        }
      },
      {
        name: 'Wide image',
        type: 'widget',
        widget: 'image',
        attributes: {
          'class': 'image-wide'
        }
      }
    ],
    // Configure the Enhanced Image plugin to use classes instead of styles and to disable the
    // resizer (because image size is controlled by widget styles or the image takes maximum
    // 100% of the editor width).
    image2_alignClasses: ['image-align-left', 'image-align-center', 'image-align-right'],
    image2_disableResizer: true
  });
</script>

<script>
  CKEDITOR.replace('editor1', {
    extraPlugins: 'uploadimage,image2',
    height: 300,
    filebrowserBrowseUrl: '/Filemanager/',
    filebrowserUploadUrl: '/uploader1/upload?Type=File',
    filebrowserImageUploadUrl: '/uploader1/upload?Type=Image',
    filebrowserFlashUploadUrl: '/uploader1/upload?Type=Flash',
    stylesSet: [{
        name: 'Narrow image',
        type: 'widget',
        widget: 'image',
        attributes: {
          'class': 'image-narrow'
        }
      },
      {
        name: 'Wide image',
        type: 'widget',
        widget: 'image',
        attributes: {
          'class': 'image-wide'
        }
      }
    ],
    // Configure the Enhanced Image plugin to use classes instead of styles and to disable the
    // resizer (because image size is controlled by widget styles or the image takes maximum
    // 100% of the editor width).
    image2_alignClasses: ['image-align-left', 'image-align-center', 'image-align-right'],
    image2_disableResizer: true
  });
</script>

<script>
  $("#close-add-article").click(function() {
    $(".add-article-noithathungthinh").css("display", "none");
    window.location.reload(true);
    $(".wrap-content").css("opacity", "1");
    $(".add-button").css("z-index", "1");
  });
  $("#add-button").click(function() {
    $(".add-article-noithathungthinh").css("display", "block");
    $(".wrap-content").css("opacity", "1");
    $(".add-button").css("z-index", "-1");
  });
  $(".deleteCategory").click(function() {
    var cButton = $(this);
    var id = $(this).attr('idArticle');
    var retVal = confirm("Do you want to continue ?");
    if( retVal == true ){
      $.ajax({
        type: "POST",
        success: function(result) {
          if (result == 'success')
            cButton.parent().parent().remove();
          else {
            alert(result);
          }

        },
        url: "noi-that-hung-thinh/delete",
        data: {
          id: id
        },
      });
      return true;
    }
    else{
      return false;
    }

  });

  $(".editCategory").click(function() {
    var id = $(this).attr('idArticle');
    $(".edit-article-noithathungthinh").css("display", "block");
    $(".wrap-content").css("opacity", "1");
    $(".add-button").css("z-index", "-1");
    $("#edit-id").val(id);

    $.ajax({
      type: "POST",
      url: "noi-that-hung-thinh/edit",
      data: {
        id: id
      },
      success: function(data) {
        if (data){
          $('#edit-title').val(data[0].title);
          $('#edit-url').val(data[0].url);
          $('#edit-type').val(data[0].type);
          $('#edit-imageULR').val(data[0].image.src);
          $('#edit-altImage').val(data[0].image.alt);
          $('#edit-product_code').val(data[0].product_code);
          $('#edit-material').val(data[0].material);
          $('#edit-size').val(data[0].size);
          $('#edit-color').val(data[0].color);
          $('#edit-status').val(data[0].status);
          $('#edit-guarantee').val(data[0].guarantee);
          $('#edit-price-real').val(data[0].price.real);
          $('#edit-price-promotion').val(data[0].price.promotion);
           CKEDITOR.instances.editor1.insertHtml(data[0].content);
        }
        else {
          alert("Khong the edit, lien he vs admin de duoc fix loi");
        }
      }
    });
  });

  $("#close-edit-article").click(function() {
    $(".edit-article-noithathungthinh").css("display", "none");
    window.location.reload(true);
    $(".wrap-content").css("opacity", "1");
    $(".add-button").css("z-index", "1");
  });
</script>

<script>
  $("#noi-that-hung-thinh").addClass("active");
</script>

<!------------ Upload image -------------- -->
<script>
  var formData = new FormData();
  $('input[type="file"]').change(function() {
    var fileName = this.files[0].name;
    var fileSize = this.files[0].size;
    var fileType = this.files[0].type;

    if (!this.files) return;

    var d = new Date();
    var n = d.getTime().toString();

    formData.append('file', this.files[0], n + this.files[0].name);

    $('#imageULR').val("/images/" + n + this.files[0].name);
  });
</script>
